<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>


   <extension
         point="org.eclipse.ui.perspectives">
      <perspective
            class="ummisco.gama.ui.perspective.SimulationPerspective"
            fixed="false"
            icon="platform:/plugin/ummisco.gama.ui.shared/icons/perspective.simulation2.png"
            id="msi.gama.application.perspectives.SimulationPerspective"
            name="Simulation">
         <description>
            The base perspective definition for simulation perspectives
         </description>
      </perspective>
   </extension>
   <extension
         point="org.eclipse.ui.perspectiveExtensions">
      <perspectiveExtension
            targetID="msi.gama.application.perspectives.SimulationPerspective">
         <viewShortcut
               id="msi.gama.application.view.ConsoleView">
         </viewShortcut>
         <viewShortcut
               id="msi.gama.application.view.ErrorView">
         </viewShortcut>
         <viewShortcut
               id="msi.gama.application.view.ParameterView">
         </viewShortcut>
      </perspectiveExtension>
   </extension>
   <extension
         point="org.eclipse.ui.views">
      <view
            allowMultiple="false"
            category="msi.gama.gui.category.gama"
            class="ummisco.gama.ui.views.console.ConsoleView"
            icon="platform:/plugin/ummisco.gama.ui.shared/icons/view.console2.png"
            id="msi.gama.application.view.ConsoleView"
            name="Console"
            restorable="false">
      </view>
      <view
            allowMultiple="true"
            category="msi.gama.gui.category.gama"
            class="ummisco.gama.ui.views.inspectors.PopulationInspectView"
            icon="platform:/plugin/ummisco.gama.ui.shared/icons/view.browser2.png"
            id="msi.gama.application.view.TableAgentInspectView"
            name="Browser"
            restorable="false">
      </view>
      <view
            allowMultiple="true"
            category="msi.gama.gui.category.gama"
            class="ummisco.gama.ui.views.inspectors.AgentInspectView"
            icon="platform:/plugin/ummisco.gama.ui.shared/icons/view.inspector2.png"
            id="msi.gama.application.view.AgentInspectView"
            name="Inspector"
            restorable="false">
      </view>
      <view
            allowMultiple="false"
            category="msi.gama.gui.category.gama"
            class="ummisco.gama.ui.views.inspectors.MonitorView"
            icon="platform:/plugin/ummisco.gama.ui.shared/icons/view.monitors2.png"
            id="msi.gama.application.view.MonitorView"
            name="Monitors"
            restorable="false">
      </view>
      <view
            allowMultiple="false"
            category="msi.gama.gui.category.gama"
            class="ummisco.gama.ui.views.inspectors.ExperimentParametersView"
            icon="platform:/plugin/ummisco.gama.ui.shared/icons/view.parameters2.png"
            id="msi.gama.application.view.ParameterView"
            name="Parameters"
            restorable="false">
      </view>
      <view
            allowMultiple="false"
            category="msi.gama.gui.category.gama"
            class="ummisco.gama.ui.views.ErrorView"
            icon="platform:/plugin/ummisco.gama.ui.shared/icons/view.errors2.png"
            id="msi.gama.application.view.ErrorView"
            name="Errors"
            restorable="false">
      </view>
      <view
            category="msi.gama.gui.category.gama"
            class="ummisco.gama.ui.views.user.UserControlView"
            fastViewWidthRatio="0.2"
            icon="platform:/plugin/ummisco.gama.ui.shared/icons/view.panel2.png"
            id="msi.gama.views.userControlView"
            name="User Control"
            restorable="false">
      </view>
   </extension>
   <extension
         point="org.eclipse.ui.menus">
      <menuContribution
            locationURI="menu:org.eclipse.ui.main.menu">
         <menu
               id="simulationMenu"
               label="Experiment">
            <visibleWhen
                  checkEnabled="false">
               <reference
                     definitionId="isSimulationReady">
               </reference>
            </visibleWhen>
            <command
                  commandId="msi.gama.application.commands.PlaySimulation"
                  icon="platform:/plugin/ummisco.gama.ui.shared/icons/menu.run4.png"
                  label="Run Experiment"
                  style="push">
               <visibleWhen
                     checkEnabled="false">
                  <reference
                        definitionId="isSimulationPaused">
                  </reference>
               </visibleWhen>
            </command>
            <command
                  commandId="msi.gama.application.commands.PauseSimulation"
                  icon="platform:/plugin/ummisco.gama.ui.shared/icons/menu.pause4.png"
                  label="Pause Experiment"
                  mnemonic="M1+P"
                  style="push">
               <visibleWhen
                     checkEnabled="false">
                  <reference
                        definitionId="isSimulationRunning">
                  </reference>
               </visibleWhen>
            </command>
            <command
                  commandId="msi.gama.application.commands.StepByStepSimulation"
                  icon="platform:/plugin/ummisco.gama.ui.shared/icons/menu.step4.png"
                  label="Step Experiment"
                  style="push"
                  tooltip="Advance the experiment step by step">
               <visibleWhen
                     checkEnabled="false">
                  <reference
                        definitionId="isSimulationReady">
                  </reference>
               </visibleWhen>
            </command>
            <command
                  commandId="msi.gama.application.commands.StepBackSimulation"
                  icon="platform:/plugin/ummisco.gama.ui.shared/icons/menu.stepBack1.png"
                  label="Step Back Experiment"
                  style="push"
                  tooltip="Make One step back in the simulation">
               <visibleWhen
                     checkEnabled="false">
                  <and>
                     <reference
                           definitionId="isSimulationReady">
                     </reference>
                     <reference
                           definitionId="isSimulationMemorize">
                     </reference>
                  </and>
               </visibleWhen>
            </command>
            <separator
                  name="msi.gama.application.separator1"
                  visible="true">
            </separator>
            <command
                  commandId="msi.gama.application.commands.ReloadSimulation"
                  icon="platform:/plugin/ummisco.gama.ui.shared/icons/menu.reload4.png"
                  label="Reload Experiment"
                  mnemonic="M1+M2+R"
                  style="push">
            </command>
            <separator
                  name="msi.gama.application.separator2"
                  visible="true">
            </separator>
            <command
                  commandId="msi.gama.application.commands.PauseAndEdit"
                  icon="platform:/plugin/ummisco.gama.ui.shared/icons/menu.stop2.png"
                  label="Stop at first error"
                  style="toggle">
            </command>
            <command
                  commandId="msi.gama.application.commands.WarningsAsErrors"
                  icon="platform:/plugin/ummisco.gama.ui.shared/icons/menu.warning2.png"
                  label="Treat warnings like errors"
                  style="toggle">
            </command>
            <command
                  commandId="msi.gama.application.ShowErrors"
                  icon="platform:/plugin/ummisco.gama.ui.shared/icons/menu.show2.png"
                  label="Display errors and warnings"
                  style="toggle">
            </command>
            <separator
                  name="msi.gama.application.separator3"
                  visible="true">
            </separator>
            <command
                  commandId="msi.gama.application.commands.Cancel"
                  icon="platform:/plugin/ummisco.gama.ui.shared/icons/toolbar.stop2.png"
                  label="Close Experiment"
                  style="push"
                  tooltip="Stops the current experiment and dispose of it.">
               <visibleWhen
                     checkEnabled="false">
                  <and>
                     <reference
                           definitionId="isInSimulationPerspective">
                     </reference>
                     <reference
                           definitionId="isSimulationExisting">
                     </reference>
                  </and>
               </visibleWhen>
            </command>
         </menu>
         <menu
               label="Agents">
            <dynamic
                  class="ummisco.gama.ui.menus.AgentsMenu"
                  id="msi.gama.application.agents.menu">
            </dynamic>
            <visibleWhen
                  checkEnabled="false">
               <reference
                     definitionId="isSimulationReady">
               </reference>
            </visibleWhen>
         </menu>
         <menu
               id="viewMenu"
               label="Views">
            <command
                  commandId="msi.gama.application.command.interactive"
                  icon="platform:/plugin/ummisco.gama.ui.shared/icons/view.interactive.png"
                  label="Interactive Console"
                  style="push">
            </command>
            <command
                  commandId="org.eclipse.ui.window.hideShowEditors"
                  icon="platform:/plugin/ummisco.gama.ui.shared/icons/menu.save.perspective.png"
                  label="Hide/Show Editors"
                  style="push"
                  tooltip="Hide or show the editors">
            </command>
            <separator
                  name="msi.gama.application.separator3"
                  visible="true">
            </separator>
            <command
                  commandId="msi.gama.application.commands.ShowHideParametersView"
                  icon="platform:/plugin/ummisco.gama.ui.shared/icons/menu.open.parameters2.png"
                  label="Parameters"
                  style="push">
               <visibleWhen
                     checkEnabled="false">
                  <reference
                        definitionId="isSimulationReady">
                  </reference>
               </visibleWhen>
            </command>
            <command
                  commandId="msi.gama.application.commands.ShowHideConsoleView"
                  icon="platform:/plugin/ummisco.gama.ui.shared/icons/menu.open.console2.png"
                  label="Console"
                  style="push">
               <visibleWhen
                     checkEnabled="false">
                  <reference
                        definitionId="isSimulationReady">
                  </reference>
               </visibleWhen>
            </command>
            <command
                  commandId="msi.gama.application.commands.AddMonitor"
                  icon="platform:/plugin/ummisco.gama.ui.shared/icons/menu.monitor2.png"
                  label="Add Monitor"
                  style="push">
               <visibleWhen
                     checkEnabled="false">
                  <reference
                        definitionId="isSimulationReady">
                  </reference>
               </visibleWhen>
            </command>
            <separator
                  name="msi.gama.application.window.views"
                  visible="true">
            </separator>
            <menu
                  icon="platform:/plugin/ummisco.gama.ui.shared/icons/layout.stack.png"
                  label="Manage outputs...">
               <visibleWhen
                     checkEnabled="false">
                  <reference
                        definitionId="isSimulationReady">
                  </reference>
               </visibleWhen>
               <dynamic
                     class="ummisco.gama.ui.menus.OutputsMenu"
                     id="ummisco.gama.ui.experiment.outputs.menu">
               </dynamic>
            </menu>
            <menu
                  icon="platform:/plugin/ummisco.gama.ui.shared/icons/menu.layout.png"
                  label="Arrange outputs...">
               <command
                     commandId="msi.gama.application.layoutDisplays"
                     icon="platform:/plugin/ummisco.gama.ui.shared/icons/layout.stack.png"
                     label="Stacked"
                     style="push">
                  <parameter
                        name="msi.gama.displays.layout"
                        value="Stacked">
                  </parameter>
               </command>
               <command
                     commandId="msi.gama.application.layoutDisplays"
                     icon="platform:/plugin/ummisco.gama.ui.shared/icons/layout.grid.png"
                     label="Split"
                     style="push">
                  <parameter
                        name="msi.gama.displays.layout"
                        value="Split">
                  </parameter>
               </command>
               <command
                     commandId="msi.gama.application.layoutDisplays"
                     icon="platform:/plugin/ummisco.gama.ui.shared/icons/layout.horizontal.png"
                     label="Horizontally"
                     style="push">
                  <parameter
                        name="msi.gama.displays.layout"
                        value="Horizontal">
                  </parameter>
               </command>
               <command
                     commandId="msi.gama.application.layoutDisplays"
                     icon="platform:/plugin/ummisco.gama.ui.shared/icons/layout.vertical.png"
                     label="Vertically"
                     style="push">
                  <parameter
                        name="msi.gama.displays.layout"
                        value="Vertical">
                  </parameter>
               </command>
               <visibleWhen
                     checkEnabled="false">
                  <and>
                     <reference
                           definitionId="isSimulationReady">
                     </reference>
                     <reference
                           definitionId="isInSimulationPerspective">
                     </reference>
                  </and>
               </visibleWhen>
            </menu>
            <menu
                  icon="platform:/plugin/ummisco.gama.ui.shared/icons/menu.other.png"
                  label="Other...">
               <menu
                     icon="platform:/plugin/ummisco.gama.ui.shared/icons/menu.open.perspective2.png"
                     label="Switch to Perspective...">
                  <command
                        commandId="msi.gama.application.goto.modeling"
                        icon="platform:/plugin/ummisco.gama.ui.shared/icons/perspective.modeling2.png"
                        label="Modeling"
                        style="push"
                        tooltip="Open modeling perspective">
                     <visibleWhen
                           checkEnabled="false">
                        <not>
                           <reference
                                 definitionId="isInModelingPerspective">
                           </reference>
                        </not>
                     </visibleWhen>
                  </command>
                  <command
                        commandId="msi.gama.application.goto.simulation"
                        icon="platform:/plugin/ummisco.gama.ui.shared/icons/perspective.simulation2.png"
                        label="Simulation"
                        style="push"
                        tooltip="Open simulation perspective">
                     <visibleWhen
                           checkEnabled="false">
                        <not>
                           <reference
                                 definitionId="isInSimulationPerspective">
                           </reference>
                        </not>
                     </visibleWhen>
                  </command>
               </menu>
               <command
                     commandId="org.eclipse.ui.window.resetPerspective"
                     icon="platform:/plugin/ummisco.gama.ui.shared/icons/menu.reset.perspective2.png"
                     label="Reset Perspective..."
                     style="push">
               </command>
               <separator
                     name="msi.gama.application.window.perspectives"
                     visible="true">
               </separator>
               <menu
                     icon="platform:/plugin/ummisco.gama.ui.shared/icons/menu.open.view2.png"
                     label="Show View">
                  <dynamic
                        class="ummisco.gama.ui.commands.ShowViewContributionItem"
                        id="msi.gama.application.showView">
                  </dynamic>
               </menu>
               <command
                     commandId="org.eclipse.ui.ToggleCoolbarAction"
                     icon="platform:/plugin/ummisco.gama.ui.shared/icons/menu.toolbar2.png"
                     label="Toggle Toolbar"
                     style="push"
                     tooltip="Toggle the main toolbar on and off">
               </command>
            </menu>
         </menu>
      </menuContribution>
      <menuContribution
            locationURI="toolbar:org.eclipse.ui.main.toolbar?after=msi.gama.application.common.toolbar">
         <toolbar
               id="msi.gama.application.experiment.toolbar"
               label="Experiment">
            <command
                  commandId="msi.gama.application.goto.simulation"
                  icon="platform:/plugin/ummisco.gama.ui.shared/icons/perspective.simulation2.png"
                  label="Simulation perspective"
                  style="push"
                  tooltip="Open simulation perspective">
               <visibleWhen
                     checkEnabled="false">
                  <and>
                     <reference
                           definitionId="isInModelingPerspective">
                     </reference>
                  </and>
               </visibleWhen>
            </command>
            <control
                  class="ummisco.gama.ui.controls.Separator"
                  id="separator2876">
            </control>
            <control
                  class="ummisco.gama.ui.controls.StatusControlContribution"
                  id="msi.gama.application.status">
            </control>
            <command
                  commandId="ummisco.gama.ui.experiment.dummy"
                  icon="platform:/plugin/ummisco.gama.ui.shared/icons/windows_spacer.png"
                  style="push"
                  tooltip="  ">
            </command>
            <command
                  commandId="msi.gama.application.commands.PlaySimulation"
                  icon="platform:/plugin/ummisco.gama.ui.shared/icons/menu.run4.png"
                  label="Run Experiment"
                  style="push"
                  tooltip="Run the currently opened experiment">
               <visibleWhen
                     checkEnabled="false">
                  <reference
                        definitionId="isSimulationPaused">
                  </reference>
               </visibleWhen>
            </command>
            <command
                  commandId="msi.gama.application.commands.PauseSimulation"
                  icon="platform:/plugin/ummisco.gama.ui.shared/icons/menu.pause4.png"
                  label="Pause Experiment"
                  style="push"
                  tooltip="Pause the currently opened experiment">
               <visibleWhen
                     checkEnabled="false">
                  <reference
                        definitionId="isSimulationRunning">
                  </reference>
               </visibleWhen>
            </command>
            <command
                  commandId="msi.gama.application.commands.StepByStepSimulation"
                  icon="platform:/plugin/ummisco.gama.ui.shared/icons/menu.step4.png"
                  label="Step Experiment"
                  style="push"
                  tooltip="Advance the experiment step by step">
               <visibleWhen
                     checkEnabled="false">
                  <reference
                        definitionId="isSimulationReady">
                  </reference>
               </visibleWhen>
            </command>
            <command
                  commandId="msi.gama.application.commands.StepBackSimulation"
                  icon="platform:/plugin/ummisco.gama.ui.shared/icons/menu.stepBack1.png"
                  label="Step Back"
                  style="push"
                  tooltip="Make One step back in the simulation">
               <visibleWhen
                     checkEnabled="false">
                  <and>
                     <reference
                           definitionId="isSimulationReady">
                     </reference>
                     <reference
                           definitionId="isSimulationMemorize">
                     </reference>
                  </and>
               </visibleWhen>
            </command>
            <control
                  class="ummisco.gama.ui.controls.SimulationSpeedContributionItem"
                  id="msi.gama.application.speed">
               <visibleWhen
                     checkEnabled="false">
                  <reference
                        definitionId="isSimulationReady">
                  </reference>
               </visibleWhen>
            </control>
            <command
                  commandId="msi.gama.application.commands.ReloadSimulation"
                  icon="platform:/plugin/ummisco.gama.ui.shared/icons/menu.reload4.png"
                  label="Reload Experiment"
                  mnemonic="M1+M2+R"
                  style="push">
               <visibleWhen
                     checkEnabled="false">
                  <and>
                     <reference
                           definitionId="isInSimulationPerspective">
                     </reference>
                     <reference
                           definitionId="isSimulationExisting">
                     </reference>
                  </and>
               </visibleWhen>
            </command>
            <command
                  commandId="msi.gama.application.commands.Cancel"
                  icon="platform:/plugin/ummisco.gama.ui.shared/icons/toolbar.stop2.png"
                  label="Close Experiment"
                  style="push"
                  tooltip="Stops the currently opened experiment and closes its perspective">
               <visibleWhen
                     checkEnabled="false">
                  <and>
                     <reference
                           definitionId="isInSimulationPerspective">
                     </reference>
                     <reference
                           definitionId="isSimulationExisting">
                     </reference>
                  </and>
               </visibleWhen>
            </command>
         </toolbar>
      </menuContribution>
   </extension>
   <extension
         point="org.eclipse.ui.handlers">
      <handler
            class="ummisco.gama.ui.commands.StepBackHandler"
            commandId="msi.gama.application.commands.StepBackSimulation">
         <activeWhen>
            <with
                  variable="msi.gama.application.commands.SimulationStepBack">
               <equals
                     value="CAN_STEP_BACK">
               </equals>
            </with>
         </activeWhen>
         <enabledWhen>
            <with
                  variable="msi.gama.application.commands.SimulationStepBack">
               <equals
                     value="CAN_STEP_BACK">
               </equals>
            </with>
         </enabledWhen>
      </handler>
      <handler
            class="ummisco.gama.ui.commands.PlayPauseSimulationHandler"
            commandId="msi.gama.application.commands.PlaySimulation">
         <activeWhen>
            <reference
                  definitionId="isSimulationReady">
            </reference>
         </activeWhen>
         <enabledWhen>
            <reference
                  definitionId="isSimulationReady">
            </reference>
         </enabledWhen>
      </handler>
      <handler
            class="ummisco.gama.ui.commands.StepByStepHandler"
            commandId="msi.gama.application.commands.StepByStepSimulation">
         <activeWhen>
            <and>
               <reference
                     definitionId="isSimulationReady">
               </reference>
               <not>
                  <reference
                        definitionId="isSimulationBatch">
                  </reference>
               </not>
            </and>
         </activeWhen>
         <enabledWhen>
            <and>
               <reference
                     definitionId="isSimulationReady">
               </reference>
               <not>
                  <reference
                        definitionId="isSimulationRunning">
                  </reference>
               </not>
            </and>
         </enabledWhen>
      </handler>
      <handler
            class="ummisco.gama.ui.commands.ReloadSimulationHandler"
            commandId="msi.gama.application.commands.ReloadSimulation">
         <activeWhen>
            <reference
                  definitionId="isSimulationReady">
            </reference>
         </activeWhen>
      </handler>
      <handler
            class="ummisco.gama.ui.commands.AddMonitorHandler"
            commandId="msi.gama.application.commands.AddMonitor">
         <activeWhen>
            <reference
                  definitionId="isSimulationReady">
            </reference>
         </activeWhen>
      </handler>
      <handler
            class="ummisco.gama.ui.commands.ShowHideParametersViewHandler"
            commandId="msi.gama.application.commands.ShowHideParametersView">
         <activeWhen>
            <reference
                  definitionId="isSimulationReady">
            </reference>
         </activeWhen>
      </handler>
      <handler
            class="ummisco.gama.ui.commands.ShowHideConsoleViewHandler"
            commandId="msi.gama.application.commands.ShowHideConsoleView">
         <activeWhen>
            <reference
                  definitionId="isSimulationReady">
            </reference>
         </activeWhen>
      </handler>
      <handler
            class="ummisco.gama.ui.commands.CancelRun"
            commandId="msi.gama.application.commands.Cancel">
         <activeWhen>
            <reference
                  definitionId="isInSimulationPerspective">
            </reference>
         </activeWhen>
      </handler>
      <handler
            class="ummisco.gama.ui.commands.ErrorsPauseAndEdit"
            commandId="msi.gama.application.commands.PauseAndEdit">
      </handler>
      <handler
            class="ummisco.gama.ui.commands.TreatWarningsAsErrors"
            commandId="msi.gama.application.commands.WarningsAsErrors">
      </handler>
      <handler
            class="ummisco.gama.ui.commands.ShowErrors"
            commandId="msi.gama.application.ShowErrors">
      </handler>
      <handler
            class="ummisco.gama.ui.commands.ResetSimulationPerspective"
            commandId="org.eclipse.ui.window.resetPerspective">
         <activeWhen>
            <reference
                  definitionId="isInSimulationPerspective">
            </reference>
         </activeWhen>
      </handler>
      <handler
            class="ummisco.gama.ui.commands.SwitchToModeling"
            commandId="msi.gama.application.goto.modeling">
         <activeWhen>
            <or>
               <reference
                     definitionId="isSimulationReady">
               </reference>
               <reference
                     definitionId="isSimulationFinished">
               </reference>
            </or>
         </activeWhen>
      </handler>
      <handler
            class="ummisco.gama.ui.commands.ArrangeDisplayViews"
            commandId="msi.gama.application.layoutDisplays">
         <activeWhen>
            <and>
               <reference
                     definitionId="isInSimulationPerspective">
               </reference>
               <reference
                     definitionId="isSimulationReady">
               </reference>
            </and>
         </activeWhen>
      </handler>
      <handler
            class="ummisco.gama.ui.commands.SwitchToSimulation"
            commandId="msi.gama.application.goto.simulation">
         <activeWhen>
            <and>
               <reference
                     definitionId="isInModelingPerspective">
               </reference>
               <not>
                  <with
                        variable="ummisco.gama.ui.experiment.SimulationRunningState">
                     <equals
                           value="NONE">
                     </equals>
                  </with>
               </not>
            </and>
         </activeWhen>
      </handler>
   </extension>
   <extension
         point="org.eclipse.ui.contexts">
      <context
            id="msi.gama.application.simulation.context"
            name="In Experiments"
            parentId="org.eclipse.ui.contexts.dialogAndWindow">
      </context>
   </extension>
   <extension
         point="org.eclipse.core.expressions.definitions">
      <definition
            id="isSimulationReady">
         <and>
            <reference
                  definitionId="isInSimulationPerspective">
            </reference>
            <or>
               <with
                     variable="ummisco.gama.ui.experiment.SimulationRunningState">
                  <equals
                        value="RUNNING">
                  </equals>
               </with>
               <with
                     variable="ummisco.gama.ui.experiment.SimulationRunningState">
                  <equals
                        value="STOPPED">
                  </equals>
               </with>
            </or>
         </and>
      </definition>
      <definition
            id="isSimulationRunning">
         <and>
            <reference
                  definitionId="isInSimulationPerspective">
            </reference>
            <with
                  variable="ummisco.gama.ui.experiment.SimulationRunningState">
               <equals
                     value="RUNNING">
               </equals>
            </with>
         </and>
      </definition>
      <definition
            id="isSimulationPaused">
         <and>
            <reference
                  definitionId="isInSimulationPerspective">
            </reference>
            <with
                  variable="ummisco.gama.ui.experiment.SimulationRunningState">
               <equals
                     value="STOPPED">
               </equals>
            </with>
         </and>
      </definition>
      <definition
            id="isSimulationExisting">
         <and>
            <reference
                  definitionId="isInSimulationPerspective">
            </reference>
            <not>
               <with
                     variable="ummisco.gama.ui.experiment.SimulationRunningState">
                  <equals
                        value="NONE">
                  </equals>
               </with>
            </not>
         </and>
      </definition>
      <definition
            id="isGamlEditorOpened">
         <and>
            <reference
                  definitionId="isActiveEditorAnInstanceOfXtextEditor">
            </reference>
            <with
                  variable="activeEditor">
               <test
                     forcePluginActivation="true"
                     property="org.eclipse.xtext.ui.editor.XtextEditor.languageName"
                     value="msi.gama.lang.gaml.Gaml">
               </test>
            </with>
         </and>
      </definition>
      <definition
            id="isSimulationBatch">
         <and>
            <reference
                  definitionId="isInSimulationPerspective">
            </reference>
            <with
                  variable="ummisco.gama.ui.experiment.SimulationType">
               <equals
                     value="BATCH">
               </equals>
            </with>
         </and>
      </definition>
      <definition
            id="isSimulationMemorize">
         <and>
            <reference
                  definitionId="isInSimulationPerspective">
            </reference>
            <with
                  variable="ummisco.gama.ui.experiment.SimulationType">
               <equals
                     value="MEMORIZE">
               </equals>
            </with>
         </and>
      </definition>
      <definition
            id="isInModelingPerspective">
         <with
               variable="activeWorkbenchWindow.activePerspective">
            <equals
                  value="msi.gama.application.perspectives.ModelingPerspective">
            </equals>
         </with>
      </definition>
      <definition
            id="isInSimulationPerspective">
         <with
               variable="activeWorkbenchWindow.activePerspective">
            <test
                  property="ummisco.gama.ui.containsString"
                  value="Simulation">
            </test>
         </with>
      </definition>
      <definition
            id="isSimulationFinished">
         <and>
            <reference
                  definitionId="isInSimulationPerspective">
            </reference>
            <with
                  variable="ummisco.gama.ui.experiment.SimulationRunningState">
               <equals
                     value="FINISHED">
               </equals>
            </with>
         </and>
      </definition>
   </extension>
   <extension
         point="org.eclipse.ui.commands">
      <command
            categoryId="msi.gama.category"
            defaultHandler="ummisco.gama.ui.commands.PlayPauseSimulationHandler"
            id="msi.gama.application.commands.PlaySimulation"
            name="Play Experiment">
      </command>
      <command
            categoryId="msi.gama.category"
            defaultHandler="ummisco.gama.ui.commands.PlayPauseSimulationHandler"
            id="msi.gama.application.commands.PauseSimulation"
            name="Pause Simulation">
      </command>
      <command
            categoryId="msi.gama.category"
            id="msi.gama.application.commands.StepByStepSimulation"
            name="Next Step">
      </command>
      <command
            categoryId="msi.gama.category"
            id="msi.gama.application.commands.StepBackSimulation"
            name="Previous Step ">
      </command>
      <command
            categoryId="msi.gama.category"
            defaultHandler="ummisco.gama.ui.commands.ReloadSimulationHandler"
            id="msi.gama.application.commands.ReloadSimulation"
            name="Reload Simulation">
      </command>
      <command
            categoryId="msi.gama.category"
            defaultHandler="ummisco.gama.ui.commands.ShowHideParametersViewHandler"
            id="msi.gama.application.commands.ShowHideParametersView"
            name="Show parameters">
      </command>
      <command
            categoryId="msi.gama.category"
            id="msi.gama.application.commands.AddMonitor"
            name="Add a monitor">
      </command>
      <command
            categoryId="msi.gama.category"
            id="msi.gama.application.commands.ShowHideConsoleView"
            name="Show console">
      </command>
      <command
            categoryId="msi.gama.category"
            id="msi.gama.application.commands.Cancel"
            name="Cancel">
      </command>
      <command
            categoryId="msi.gama.category"
            id="msi.gama.application.commands.PauseAndEdit"
            name="Pause at first error">
      </command>
      <command
            categoryId="msi.gama.category"
            id="msi.gama.application.commands.WarningsAsErrors"
            name="Treat warnings like errors">
      </command>
      <command
            categoryId="msi.gama.category"
            id="msi.gama.application.ShowErrors"
            name="Display errors and warnings">
      </command>
      <command
            categoryId="msi.gama.category"
            id="msi.gama.application.goto.modeling"
            name="Switch to modeling perspective">
      </command>
      <command
            categoryId="msi.gama.category"
            id="msi.gama.application.layoutDisplays"
            name="Layout display views">
         <commandParameter
               id="msi.gama.displays.layout"
               name="layout"
               optional="false"
               typeId="msi.gama.application.String">
         </commandParameter>
      </command>
      <command
            categoryId="msi.gama.category"
            id="msi.gama.application.goto.simulation"
            name="Switch to simulation perspective">
      </command>
      <command
            defaultHandler="ummisco.gama.ui.commands.DummyHandler"
            id="ummisco.gama.ui.experiment.dummy"
            name="Separator">
      </command>
      <command
            defaultHandler="ummisco.gama.ui.commands.ShowInteractiveConsole"
            id="msi.gama.application.command.interactive"
            name="Show Interactive Console">
      </command>
   </extension>
   <extension
         point="org.eclipse.ui.services">
      <serviceFactory
            factoryClass="ummisco.gama.ui.factories.AgentMenuFactory">
         <service
               serviceClass="ummisco.gama.ui.interfaces.IAgentMenuFactory"></service>
      </serviceFactory>
      <serviceFactory
            factoryClass="ummisco.gama.ui.factories.UserDialogFactory">
         <service
               serviceClass="ummisco.gama.ui.interfaces.IUserDialogFactory"></service>
      </serviceFactory>
      <sourceProvider
            provider="ummisco.gama.ui.commands.SimulationStateProvider">
         <variable
               name="ummisco.gama.ui.experiment.SimulationRunningState"
               priorityLevel="workbench">
         </variable>
         <variable
               name="ummisco.gama.ui.experiment.SimulationType"
               priorityLevel="workbench">
         </variable>
      </sourceProvider>
      <serviceFactory
            factoryClass="ummisco.gama.ui.factories.SpeedDisplayerFactory">
         <service
               serviceClass="ummisco.gama.ui.interfaces.ISpeedDisplayer">
         </service>
      </serviceFactory>
      <serviceFactory
            factoryClass="ummisco.gama.ui.factories.StatusDisplayerFactory">
         <service
               serviceClass="msi.gama.common.interfaces.IStatusDisplayer">
         </service>
      </serviceFactory>
      <serviceFactory
            factoryClass="ummisco.gama.ui.factories.ConsoleDisplayerFactory">
         <service
               serviceClass="msi.gama.common.interfaces.IConsoleDisplayer">
         </service>
      </serviceFactory>
      <serviceFactory
            factoryClass="ummisco.gama.ui.factories.DisplayLayoutFactory">
         <service
               serviceClass="ummisco.gama.ui.interfaces.IDisplayLayoutManager">
         </service>
      </serviceFactory>
      <serviceFactory
            factoryClass="ummisco.gama.ui.factories.RuntimeExceptionHandlerFactory">
         <service
               serviceClass="msi.gama.common.interfaces.IRuntimeExceptionHandler">
         </service>
      </serviceFactory>
   </extension>
   <extension
         point="org.eclipse.core.expressions.propertyTesters">
      <propertyTester
            class="ummisco.gama.ui.perspective.PerspectiveNamePropertyTester"
            id="ummisco.gama.ui.PerspectiveNamePropertyTester"
            namespace="ummisco.gama.ui"
            properties="containsString"
            type="java.lang.Object">
      </propertyTester>
   </extension>

</plugin>
